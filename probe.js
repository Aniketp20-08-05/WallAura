const http = require('http');
function probe(url){ return new Promise((resolve,reject)=>{ http.get(url, res=>{ let data=''; res.on('data', d=> data += d); res.on('end', ()=> resolve({status:res.statusCode, headers: res.headers, body: data.slice(0,500)})); }).on('error', e=> reject(e)); }); }
(async ()=>{ try{ const r1 = await probe('http://localhost:4000/proxy'); console.log('ROOT', r1.status); console.log('BODY', r1.body); const sample = 'https://images.unsplash.com/photo-1501785888041-af3ef285b470?w=1000&q=80&auto=format&fit=crop'; const r2 = await probe('http://localhost:4000/proxy?url='+encodeURIComponent(sample)); console.log('SAMPLE STATUS', r2.status); console.log('SAMPLE HEADERS', JSON.stringify(r2.headers).slice(0,500)); console.log('SAMPLE BODY START', r2.body.slice(0,140)); } catch(e){ console.error('PROBE ERR', e && e.message); process.exit(2); } })();
